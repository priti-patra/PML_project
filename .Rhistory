t<-(-4)/sqrt(sp2/9+sp2/9)
t
pt(t,16,lower.tail=FALSE)
pt(t,16)
pt(t,16)*2
pt(t,16)*100
t1<-(-4)/sqrt(1.5^2/9+1.8^2/9)
t1
pt(t,16,lower.tail=FALSE)
pt(t,16)
pt(t,16)*2
pt(t,16,lower.tail=FALSE)*2
pt(t,16,lower.tail=FALSE)
pt(t,16)
pt(t,16)*2
?download.file
download.file("https://spark-public.s3.amazonaws.com/datasci/Coursera-Data-Science-Ubuntu.ova",dest="Coursera-Data-Science-Ubuntu.ova")
download.file("http://spark-public.s3.amazonaws.com/datasci/Coursera-Data-Science-Ubuntu.ova",dest="Coursera-Data-Science-Ubuntu.ova")
getwd()
dir()
rm "Coursera-Data-Science-Ubuntu.ova"
rm Coursera-Data-Science-Ubuntu.ova
rm "Coursera-Data-Science-Ubuntu.ova"
download.file("http://spark-public.s3.amazonaws.com/datasci/Coursera-Data-Science-Ubuntu.ova",dest="Coursera-Data-Science-Ubuntu.ova")
q()
x<-c(0.18,-1.54,0.42,o.95)
x<-c(0.18,-1.54,0.42,0.95)
w<-c(2,1,3,1)
w_mean<-x*w
w_mean
w_mean<-sum(w_mean)
w_mean
w_mean<-w_mean/sum(w)
w_mean
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
beta_one<-sum(y*x)/sum(x^2)
beta_one
lm(y-x-1)
lm(y~x~1)
data(mtcars)
str(mtcars)
y<-mtcars$mpg
x<-mtcars$wt
y
x
beta1<-cor(y,x)* sd(y)/sd(x)
beta1
beta0<-mean(y)-beta1*mean(x)
beta0
coef(lm(y~x))
q()
x <- c(8.58, 10.46, 9.01, 9.64, 8.86)
xn<-(x-mean(x))/sd(x)
xn
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
beta1<-cor(y,x)*sd(y)/sd(x)
beta0<-mean(y)-beta1*mean(x)
beta0
coef(lm(y~x))
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
mean(x)
q()
x <- c(0.61, 0.93, 0.83, 0.35, 0.54, 0.16, 0.91, 0.62, 0.62)
y <- c(0.67, 0.84, 0.6, 0.18, 0.85, 0.47, 1.1, 0.65, 0.36)
fit<-lm(y~x)
summary(fit)
str(summary(fit))
summary(fit)
resid(fit)
summary(fit)$sigma
data("mtcars")
view(mtcars)
View(mtcars)
str(mtcars)
x<-mtcars$wt
y<-mtcars$mpg
help(mtcars)
fit<-lm(y~x)
summary(fit)
fit<-lm(y~I(x-mean(x)))
summary(fit)
fit<-lm(y~x)
summary(fit)
fit2<-lm(y~I(x-mean(x)))
coef(fit2)
mean(x)
sumCoef <- summary(fit2)$coefficients
sumcoef
sumCoef
sumCoef[2,1] + c(-1, 1) * qt(.975, df = fit$df) * sumCoef[2, 2]
help(mtcars)
help(mtcars)
q()
data(mtcars)
str(mtcars)
fit<-lm(mpg~wt)
x<-mtcars$mpg
x<-mtcars$wt
y<-mtcars$mpg
fit<-lm(y~x)
fit2<-lm(y~I(x~mean(x
)))
fit2<-lm(y~I(x~mean(x)))
fit2<-lm(y~I(x-mean(x)))
summary(fit2)
sumCoef <- summary(fit2)$coefficients
sumCoef
sumCoef[2,1] + c(-1, 1) * qt(.975, df = fit2$df) * sumCoef[2, 2]
predict(fit, newdata= data.frame(x=3000),interval="predict")
predict(fit, newdata= data.frame(x=3000),interval="confidence")
fit<-lm(y~x/1000)
fit<-lm(y~(x/1000))
fit<-lm(y~x*.0001)
fit<-lm(y~I(x*1000))
predict(fit, newdata= data.frame(x=3000),interval="predict")
fit
fit<-lm(y~I(x*1000))
fit
predict(fit, newdata= data.frame(x=3),interval="predict")
fit<-lm(y~I(x*.0001))
predict(fit, newdata= data.frame(x=3000),interval="predict")
fit<-lm(y~I(x/1000))
predict(fit, newdata= data.frame(x=3000),interval="predict")
fit<-lm(y~I(x*1000))
sumCoef[2,1] + c(-1, 1) * qt(.975, df = fit$df) * sumCoef[2, 2]
2*(sumCoef[2,1] + c(-1, 1) * qt(.975, df = fit$df) * sumCoef[2, 2])
fit
fit<-lm(y~x))
fit<-lm(y~x)
fit
fit<-lm(y~x))
fit<-lm(y~x)
summary(fit)
sumCoef<-summary(fit)$Coefficients
sumCoef
sumCoef <- summary(fit)$coefficients
sumCoef
mean(y)
y_real<-y
fit$coefficients
fit[1]
fit$coefficients[1]
fit$coefficients[2]
fit$coef[1]
fit$coef[1,1]
fit$coefficients[2]
fit$coefficients[[2]]
fit$coefficients[[1]]
y_model1<-fit$coefficients[[1]]+fit$coefficients[[2]]
y_model<-fit$coefficients[[1]]+fit$coefficients[[2]]
y_model<-mean(y)
y_model2<-mean(y)
summary(y_model11)
summary(y_model1)
y_model1<-fit$coefficients[[1]]+fit$coefficients[[2]]*x
num<-sum((y-y_model1)^2)
num
denom<-sum(y-y_model2)^2)
denom<-sum((y-y_model2)^2)
denom
denom<-sum(y-mean(y))^2)
denom<-sum((y-mean(y))^2)
denom
num/denom
data(mtcars)
x<-mtcars$wt
y<-mtcars$mpg
fit2<-lm(y~I(x-mean(x))
)
coef(fit2)
sumCoef <- summary(fit2)$coefficients
sumCoef[2,1] + c(-1, 1) * qt(.975, df = fit2$df) * sumCoef[2, 2]
mean(x)
fit(y~x)
fit<-lm(y~x)
coef(fit)
sumCoef[1,1] + c(-1, 1) * qt(.975, df = fit2$df) * sumCoef[1, 2]
q()
pairs(mtcars, panel=panel.smooth, main="scatterplot matrix of mtcars")
pairs(mtcars, panel=panel.smooth, main="scatterplot matrix of mtcars",col=mtcars$am)
str(mtcars)
?lm
?vif
require(car)
library(car)
install.packages('car')
library(car)
?vif
?anova
example(anova)
>mtcars
?mtcars
fit<-lm(mpg~.-1,data=mtcars)
summary(fit)$coef
summary(lm(mpg~.-1,data=mtcars))$coef
data(mtcars)
names(mtcars)
mtcars$cyl <- as.factor(mtcars$cyl)
mtcars$vs <- as.factor(mtcars$vs)
mtcars$am <- as.factor(mtcars$am)
levels(mtcars$am) <-c("automatic", "manual")
mtcars$gear <- as.factor(mtcars$gear)
mtcars$carb <- as.factor(mtcars$carb)
summary(lm(mpg~.-1,data=mtcars))$coef
data(mtcars)
names(mtcars)
summary(lm(mpg~.-1,data=mtcars))$coef
?step
?mtcars
?mtcars
?hatvalues
?hatvalues
?summary.lm
?t.test
?anova
?t.test
data(mtcars)
str(mtcars)
summary(lm(mpg~factor(cyl)+wt))
summary(lm(mpg~factor(cyl)+wt,data=mtcars))
str(factor(mtcars$cyl))
summary(lm(mpg~factor(cyl)+wt-1,data=mtcars))
summary(lm(mpg~factor(cyl)+wt,data=mtcars))
summary(lm(mpg~factor(cyl),data=mtcars))
fit1<-lm(mpg~factor(cyl)+wt, data=mtcars)
fit2<-lm(mpg~factor(cyl)+wt+factor(cyl):wt, data=mtcars)
anova(fit1,fit2)
summary(lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
)
?I
?mtcars
summary(lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
)
summary(lm(mpg ~ I(wt * 0.5) + factor(cyl)-1, data = mtcars))
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
summary(lm(mpg ~wt  + factor(cyl)-1, data = mtcars))
influence.measures(lm(y~x))
?influence.measures
plot(lm(y~x))
summary(influence.measures(lm(y~x)))
summary(influence.measures(lm(y~x-1)))
summary(influence.measures(lm(y~x)))
par(mfrow=c(2,2))
plot(lm(y~x))
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
summary(influence.measures(lm(y~x)))
dfbetas(lm(y~x))
?summary.lm
summary(lm(y~x))
q()
library(MASS)
?shuttle
str(shuttle)
head(use)
head(shuttle)
shuttle$use1<-factor(shuttle$use,labels=c("0","1"))
head(shuttle)
shuttle$use1
labels(shuttle$use)
str(shuttle$use)
lavel(shuttle$use)
level(shuttle$use)
levels(shuttle$use)
shuttle$use1<-factor(shuttle$use,labels=c("1","0"))
head(shuttle)
tail(shuttle)
levles(shuttle$head)
levles(shuttle$wind)
levels(shuttle$wind)
shuttle$wind1<-factor(shuttle$use,labels=c("1","0"))
head(shuttle)
shuttle$wind1<-factor(shuttle$wind,labels=c("1","0"))
head(shuttle)
str(shuttle)
fit<-glm(shuttle$use1~shuttle$wind1,family="binomial")
summary(fit)
exp(fit$coeff)
str(shutter)
str(shuttle)
exp(glm(shuttle$use=="auto"~shuttle$wind=="head",family="binomial")$coeff)
exp(glm(shuttle$use=="auto"~shuttle$wind=="head"+shuttle$magn,family="binomial")$coeff)
fit<-glm(shuttle$use1~shuttle$wind1+shuttle$magn,family="binomial")
exp(fit$coeff)
fit<-glm(shuttle$use1~.,family="binomial")
fit<-glm(shuttle$use1~shuttle$wind1,family="binomial")
fit$coeff
fit1<-glm(shuttle$use1~1-shuttle$use1,family="binomial")
fit1$coeff
fit1<-glm(shuttle$use1~(1-shuttle$use1),family="binomial")
fit1$coeff
fit<-glm(shuttle$use1~shuttle$wind1,family="binomial")
fit$coeff
fit<-glm(1-shuttle$use1~shuttle$wind1,family="binomial")
fit<-glm((1-shuttle$use1)~shuttle$wind1,family="binomial")
glm(shuttle$use~shuttle$wind,family="binomial")$coef
glm((1-shuttle$use)~shuttle$wind,family="binomial")$coef
glm(shuttle$use~1-shuttle$use,family="binomial")$coef
shuttle$use2<-1-shuttle$use
fit$coeff
fit<-glm(shuttle$use1~shuttle$wind1,family="binomial")
fit$coeff
fit1<-glm(shuttle$use1==1-shuttle$use1~shuttle$wind1,family="binomial")
fit1<-glm(1-shuttle$use1~shuttle$wind1,family="binomial")
fit1<-glm(1-as.numeric(shuttle$use1)~shuttle$wind1,family="binomial")
fit1<-glm(1-shuttle$use1~shuttle$wind1,family="binomial")
fit1<-glm((1-shuttle$use1)~shuttle$wind1,family="binomial")
fit1<-glm(shuttle$use1==0~shuttle$wind1,family="binomial")
fit1$coef
fit$coef
glm(shuttle$use1==1~shuttle$wind1,family="binomial")$coef
glm((1-(shuttle$use1==1))~shuttle$wind1,family="binomial")$coef
glm((shuttle$use=="auto")~shuttle$wind1,family="binomial")$coef
glm((shuttle$use=="noauto")~shuttle$wind1,family="binomial")$coef
glm((1-(shuttle$use=="auto"))~shuttle$wind1,family="binomial")$coef
?InspectSprays
?InsectSprays
str(InsectSprays)
head(InsectSprays)
fit4<-glm(InsectSprays$count~factor(InsectSprays$spray),family="poisson")
summary(fit4)
exp(fit4$coeff)
fit4<-glm(InsectSprays$count~factor(InsectSprays$spray)-1,family="poisson")
exp(fit4$coeff)
exp(fit4$coeff[1])
exp(fit4$coeff[1])/exp(fit4$coeff[2])
14.5/1.05
1/1.05
1/exp(fit4$coeff[2])
1/fit4$coeff[2]
1/fit4$coeff[1]
x <- -5:5
y <- c(5.12, 3.93, 2.67, 1.87, 0.52, 0.08, 0.93, 2.05, 2.54, 3.87, 4.97)
x
splineterms<-x*(x>0)
splineterms
xMat <- cbind(1, x, splineTerms)
xMat <- cbind(1, x, splineterms)
xMat
summary(lm(y~xMat-1)
)
yhat <- predict(lm(y ~ xMat - 1))
plot(x, y, frame = FALSE, pch = 21, bg = "lightblue", cex = 2)
lines(x, yhat, col = "red", lwd = 2)
summary(lines(x, yhat, col = "red", lwd = 2))
yhat
yhat
x
yhat[7]-yhat[6]
fit4<-glm(InsectSprays$count~factor(InsectSprays$spray),family="poisson")
summary(fit4)
q()
library(swirl)
swirl()
fit<-lm(child~parent,galton)
sqrt(1/(n-2)*sum(fit$residuals^2))
info()
sqrt(sum(fit$residuals^2)/(n-2))
summary(fit)$sigma
sqrt(deviance(fit)/(n-2))
mu<-mean(galton$child)
sTot<-sum((galton$child-mu)^2)
sRes<-sqrt(deviance(fit)/(n-2))
sRes<-deviance(fit)
R^2<-1-sRes/sTot
1-sRes/sTot
summary(fit)$r.squared
(cor(galton$child,galton$parent))^2
cor(galton$child,galton$parent)^2
ones<-rep(1,nrow(galton))
lm(child~ones+parent -1, galton)
lm(child~parent,galton)
lm(child~1,galton)
head(trees)
fit<-lm(Volume~Girth + Height + Constant -1)
fit<-lm(Volume~Girth + Height + Constant -1)
fit<-lm(Volume~Girth + Height + Constant -1, trees)
tree2<- eliminate("Girth", trees)
trees2<- eliminate("Girth", trees)
head(trees2)
fit2<-lm(Volume~Height+Constant -1, trees2)
lapply(list(fit,fit2),coef)
library(swirl)
swirl()
lm(Fertility~.,swiss)
all<-lm(Fertility~.,swiss)
summary(all)
summary(lm(Fertility~Agriculture,swiss))
cor(swiss$Examination,swiss$Education)
cor(swiss$Agriculture,swiss$Education)
makelms()
ec<-swiss$Examination + swiss$Catholic
efit<-lm(Fertility~.+ec,swiss)
summary(all)$coef-summary(efit)$coef
all$coefficients-efit$coefficients
library(swirl)
swirl()
6
dim(InsectSprays)
head(InsectSprays,15)
sA
summary(InsectSprays[,2])
sapply(InsectSprays[,1:2],class)
sapply(InsectSprays,class)
fit<-lm(count~spray,Insectsprays)
fit<-lm(count~spray,InsectSprays)
summary(fit)$coef
est<-summary(fit)$coef[,1]
sum(sA)/length(sA)
mean(s)
mean(sA)
mean(sB)
nfit<-lm(count~spray-1, InsectSprays)
summary(nfit)$coef
spray2<-relevel(InsectSprays$spray,"C")
fit2<-lm(count$spray2,InsectSprays)
fit2<-lm(count~spray2,InsectSprays)
summary(fit2)$coef
mean(sC)
(fit$coef[2]-fit$coef[3])/1.6011
dim(hunger)
948
names(hunger)
fit<-lm(Numeric~Year,hunger)
summary(fit)
summary(fit)$coef
lmF<-lm(Numeric~Year,hunger[hunger$sex=="Female"])
lmF<-lm(Numeric~Year,hunger[hunger$sex=="Female",])
lmF<-lm(Numeric~Year,hunger[hunger$Sex=="Female",])
lmF<-lm(Numeric[Sex=="Female"]~Year[Sex=="Female"],hunger)
lmM<-lm(Numeric[Sex=="Male"]~Year[Sex=="Male"],hunger)
lmBoth<-lm(Numeric~Year+Sex,hunger)
summary(lmBoth)
lmInter<-lm(Numeric~Year+Sex+Sex*Year,hunger)
summary(lmInter)
fit<lm(y~x,out2)
fit<-lm(y~x,out2)
plot(fit,which=1)
fitno<-lm(y~x,out2[-1,])
plot(fitno,which=1)
coef(fit)-coef(fitno)
head(dfbeta(fit))
resno<-out2[1,"y"]-predict(fitno,out2[1,])
1-resid(fit)[1]/resno
head(hatvalues(fit))
sigma<-sqrt(deviance(fit)/(nrow(out)-2))
sigma<-sqrt(deviance(fit)/(nrow(out2)-2))
rstd<-resid(fit)/(sigma*sqrt(1-hatvalues(fit)))
head(cbind(rstd,rstandard(fit)))
plot(fit,which=3)
plot(fit,which=2)
sigma1<-sqrt(deviance(fitno)/(nrow(out2)-3))
resid(fit)[1]/(sigma1*sqrt(1-hatvalues(fit)[1]))
head(rstudent(fit))
dy<-predic(fitno,out2)-predict(fit,out2)
dy<-predict(fitno,out2)-predict(fit,out2)
sum(dy^2)/(2*sigma^2)
plot(fit,which=5)
rgp1()
rgp2()
head(swiss)
mdl<-lm(Fertility~.,swiss)
vif(mdl)
mdl2<-lm(Fertility~Agriculture+Education+Catholic+Infant.Mortality,swiss)
vif(mdl2)
x1c<-simbias()
apply(x1c,1,mean)
fit1<-lm(Fertility~Agriculture,swiss)
fit3<-lm(Fertility~Agriculture+Examination+Education,swiss)
anova(fit1.fit3)
anova(fit1,fit3)
deviance(fit3)
d<-deviance(fit3)/43
n<-deviance(fit1)-deviance(fit3)
n<-(deviance(fit1)-deviance(fit3))/2
n/d
pf(n/d,2,43,lower.tail=FALSE)
shapiro.test(fit3$residuals)
anova(fit1,fit3,fit5,fit6)
library(swirl)
swirl()
ravenData
mdl<-glm(ravenWinNum~ravenScore,binomial,ravenData)
lodds<-predict(mdl,data.frame(ravenScore=c(0,3,6)))
exp(lodds)/(1+exp(lodds))
summary(mdl)
confint(mdl)
exp(confint(mdl))
anova(mdl)
qchisq(0.95,1)
var(rpois(1000,50))
nxt()
head(hits)
class(hits[,'date'])
as.integer(head(hits[,'date']))
mdl<-glm(visits~date,poisson,hits)
summary(mdl)
exp(confint(mdl,date))
exp(confint(mdl,'date'))
which.max(hits[,'visits'])
hits[704,]
lambda<-mdl$fitted.values[704]
qpois(.95,lambda)
mdl2<-glm(counts~date,offset=log(visits+1),poisson,hits)
mdl2<-glm(count~date,offset=log(visits+1),poisson,hits)
mdl2<-glm(visits~date,offset=log(visits+1),poisson,hits)
mdl2<-glm(simplystats~date,offset=log(visits+1),poisson,hits)
qpois(.95,mdl2$fitted.values[704])
setwd("C:/Users/priti/Desktop/coursera_ds/pract_ML/PML_project/PML_project")
